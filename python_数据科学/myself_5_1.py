# IPython log file

impot seaborn as sns
import seaborn as sns
iris = sns.load_dataset('iris')
irir = sns.load_dataset('iris')
iris = sns.load_dataset('iris')
iris = sns.load_dataset('iris')
import pandas as pd
import numpy as np
data = sns.load_dataset('iris')
data = sns.load_dataset(iris)
get_ipython().run_line_magic('cd', 'c')
get_ipython().run_line_magic('ls', '')
get_ipython().run_line_magic('cd', 'data/')
get_ipython().run_line_magic('ls', '')
data = pd.read_csv('Iris_no_column.txt')
data = pd.read_csv('Iris_no_column.txt',encoding='gb2312')
data.head()
#[Out]#    5.1  3.5  1.4  0.2  Iris-setosa
#[Out]# 0  4.9  3.0  1.4  0.2  Iris-setosa
#[Out]# 1  4.7  3.2  1.3  0.2  Iris-setosa
#[Out]# 2  4.6  3.1  1.5  0.2  Iris-setosa
#[Out]# 3  5.0  3.6  1.4  0.2  Iris-setosa
#[Out]# 4  5.4  3.9  1.7  0.4  Iris-setosa
data = pd.read_csv('Iris_no_column.txt',encoding='gb2312',header=None,name=['sepal_length','sepal_width','petal_length','petal_width','specie'])
data = pd.read_csv('Iris_no_column.txt',encoding='gb2312',header=None,names=['sepal_length','sepal_width','petal_length','petal_width','specie'])
data.head()
#[Out]#   sepal_length sepal_width  petal_length  petal_width       specie
#[Out]# 0          5.1         3.5           1.4          0.2  Iris-setosa
#[Out]# 1          4.9         3.0           1.4          0.2  Iris-setosa
#[Out]# 2          4.7         3.2           1.3          0.2  Iris-setosa
#[Out]# 3          4.6         3.1           1.5          0.2  Iris-setosa
#[Out]# 4          5.0         3.6           1.4          0.2  Iris-setosa
data.shape
#[Out]# (151, 5)
get_ipython().run_line_magic('pylab', '')
import seaborn as sns
sns.set()
sns.pairplot(iris,hue='specie',size=1.5)
sns.pairplot(data,hue='specie',size=1.5)
#[Out]# <seaborn.axisgrid.PairGrid object at 0x0000020DEC92D9B0>
data.shape
#[Out]# (151, 5)
get_ipython().run_line_magic('pinfo', 'sns.pairplot')
x_iris = iris.drop('specie',axis=1)
x_data = data.drop('specie',axis=1)
x_data.shape
#[Out]# (151, 4)
x_data.head()
#[Out]#   sepal_length sepal_width  petal_length  petal_width
#[Out]# 0          5.1         3.5           1.4          0.2
#[Out]# 1          4.9         3.0           1.4          0.2
#[Out]# 2          4.7         3.2           1.3          0.2
#[Out]# 3          4.6         3.1           1.5          0.2
#[Out]# 4          5.0         3.6           1.4          0.2
y_iris = iris['species']
y_data = data['species']
y_data = data['specie']
y_data.shape
#[Out]# (151,)
import matplotlib.pyplot as plt
rng = np.random.RandomState(42)
x = 10 * rng.rand(50)
y = 2 * x -1 + rng.randn(50)
plt.scatter(x,y)
#[Out]# <matplotlib.collections.PathCollection object at 0x0000020DED525B38>
get_ipython().run_line_magic('pwd', '')
#[Out]# 'c:\\python\\python_数据科学手册\\myself_x\\data'
get_ipython().run_line_magic('cd', '..')
from sklearn.linear_model import LinearRegression
model = LinearRegression(fit_intercept=True)
model
#[Out]# LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)
x
#[Out]# array([3.74540119, 9.50714306, 7.31993942, 5.98658484, 1.5601864 ,
#[Out]#        1.5599452 , 0.58083612, 8.66176146, 6.01115012, 7.08072578,
#[Out]#        0.20584494, 9.69909852, 8.32442641, 2.12339111, 1.81824967,
#[Out]#        1.8340451 , 3.04242243, 5.24756432, 4.31945019, 2.9122914 ,
#[Out]#        6.11852895, 1.39493861, 2.92144649, 3.66361843, 4.56069984,
#[Out]#        7.85175961, 1.99673782, 5.14234438, 5.92414569, 0.46450413,
#[Out]#        6.07544852, 1.70524124, 0.65051593, 9.48885537, 9.65632033,
#[Out]#        8.08397348, 3.04613769, 0.97672114, 6.84233027, 4.40152494,
#[Out]#        1.22038235, 4.9517691 , 0.34388521, 9.09320402, 2.58779982,
#[Out]#        6.62522284, 3.11711076, 5.20068021, 5.46710279, 1.84854456])
get_ipython().run_line_magic('pinfo', 'x')
get_ipython().run_line_magic('pinfo2', 'x')
x
#[Out]# array([3.74540119, 9.50714306, 7.31993942, 5.98658484, 1.5601864 ,
#[Out]#        1.5599452 , 0.58083612, 8.66176146, 6.01115012, 7.08072578,
#[Out]#        0.20584494, 9.69909852, 8.32442641, 2.12339111, 1.81824967,
#[Out]#        1.8340451 , 3.04242243, 5.24756432, 4.31945019, 2.9122914 ,
#[Out]#        6.11852895, 1.39493861, 2.92144649, 3.66361843, 4.56069984,
#[Out]#        7.85175961, 1.99673782, 5.14234438, 5.92414569, 0.46450413,
#[Out]#        6.07544852, 1.70524124, 0.65051593, 9.48885537, 9.65632033,
#[Out]#        8.08397348, 3.04613769, 0.97672114, 6.84233027, 4.40152494,
#[Out]#        1.22038235, 4.9517691 , 0.34388521, 9.09320402, 2.58779982,
#[Out]#        6.62522284, 3.11711076, 5.20068021, 5.46710279, 1.84854456])
x = x[:,np.newaxis]
x.shape
#[Out]# (50, 1)
x
#[Out]# array([[3.74540119],
#[Out]#        [9.50714306],
#[Out]#        [7.31993942],
#[Out]#        [5.98658484],
#[Out]#        [1.5601864 ],
#[Out]#        [1.5599452 ],
#[Out]#        [0.58083612],
#[Out]#        [8.66176146],
#[Out]#        [6.01115012],
#[Out]#        [7.08072578],
#[Out]#        [0.20584494],
#[Out]#        [9.69909852],
#[Out]#        [8.32442641],
#[Out]#        [2.12339111],
#[Out]#        [1.81824967],
#[Out]#        [1.8340451 ],
#[Out]#        [3.04242243],
#[Out]#        [5.24756432],
#[Out]#        [4.31945019],
#[Out]#        [2.9122914 ],
#[Out]#        [6.11852895],
#[Out]#        [1.39493861],
#[Out]#        [2.92144649],
#[Out]#        [3.66361843],
#[Out]#        [4.56069984],
#[Out]#        [7.85175961],
#[Out]#        [1.99673782],
#[Out]#        [5.14234438],
#[Out]#        [5.92414569],
#[Out]#        [0.46450413],
#[Out]#        [6.07544852],
#[Out]#        [1.70524124],
#[Out]#        [0.65051593],
#[Out]#        [9.48885537],
#[Out]#        [9.65632033],
#[Out]#        [8.08397348],
#[Out]#        [3.04613769],
#[Out]#        [0.97672114],
#[Out]#        [6.84233027],
#[Out]#        [4.40152494],
#[Out]#        [1.22038235],
#[Out]#        [4.9517691 ],
#[Out]#        [0.34388521],
#[Out]#        [9.09320402],
#[Out]#        [2.58779982],
#[Out]#        [6.62522284],
#[Out]#        [3.11711076],
#[Out]#        [5.20068021],
#[Out]#        [5.46710279],
#[Out]#        [1.84854456]])
y
#[Out]# array([ 7.22926896, 18.18565441, 13.52423055, 10.67206599,  0.64185082,
#[Out]#         1.4000462 , -0.29896653, 17.38064514, 11.36591852, 11.3984114 ,
#[Out]#        -0.26422614, 18.01311476, 14.97193082,  3.8584585 ,  3.66749887,
#[Out]#         3.59937032,  4.24562734,  9.18591626,  7.9701638 ,  5.80012793,
#[Out]#        10.75788366,  1.60421824,  3.736558  ,  5.13103024,  8.93392551,
#[Out]#        16.05975926,  2.92146552, 10.28822167, 11.2099274 , -0.7161115 ,
#[Out]#        11.51229264,  3.94851904,  0.26520582, 19.5423544 , 15.69289556,
#[Out]#        15.98984947,  5.17932245,  0.65443493, 12.77642131,  5.81548096,
#[Out]#         1.22109281,  9.26065077,  1.16566447, 16.66813782,  3.36710603,
#[Out]#        11.74868864,  6.14962364,  9.73011153,  9.40444538,  3.21035654])
model.fit(x,y)
#[Out]# LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)
model.coef_
#[Out]# array([1.9776566])
model.intercept_
#[Out]# -0.9033107255311164
xfit = np.linspace(-1,11)
xfig
xfit
#[Out]# array([-1.        , -0.75510204, -0.51020408, -0.26530612, -0.02040816,
#[Out]#         0.2244898 ,  0.46938776,  0.71428571,  0.95918367,  1.20408163,
#[Out]#         1.44897959,  1.69387755,  1.93877551,  2.18367347,  2.42857143,
#[Out]#         2.67346939,  2.91836735,  3.16326531,  3.40816327,  3.65306122,
#[Out]#         3.89795918,  4.14285714,  4.3877551 ,  4.63265306,  4.87755102,
#[Out]#         5.12244898,  5.36734694,  5.6122449 ,  5.85714286,  6.10204082,
#[Out]#         6.34693878,  6.59183673,  6.83673469,  7.08163265,  7.32653061,
#[Out]#         7.57142857,  7.81632653,  8.06122449,  8.30612245,  8.55102041,
#[Out]#         8.79591837,  9.04081633,  9.28571429,  9.53061224,  9.7755102 ,
#[Out]#        10.02040816, 10.26530612, 10.51020408, 10.75510204, 11.        ])
np.linspace
#[Out]# <function numpy.core.function_base.linspace>
get_ipython().run_line_magic('pinfo', 'np.linspace')
len(xfit)
#[Out]# 50
xfit = xfit[:,np.newaxis]
yfit = model.predict(xfit)
type(xfit)
#[Out]# numpy.ndarray
xfit
#[Out]# array([[-1.        ],
#[Out]#        [-0.75510204],
#[Out]#        [-0.51020408],
#[Out]#        [-0.26530612],
#[Out]#        [-0.02040816],
#[Out]#        [ 0.2244898 ],
#[Out]#        [ 0.46938776],
#[Out]#        [ 0.71428571],
#[Out]#        [ 0.95918367],
#[Out]#        [ 1.20408163],
#[Out]#        [ 1.44897959],
#[Out]#        [ 1.69387755],
#[Out]#        [ 1.93877551],
#[Out]#        [ 2.18367347],
#[Out]#        [ 2.42857143],
#[Out]#        [ 2.67346939],
#[Out]#        [ 2.91836735],
#[Out]#        [ 3.16326531],
#[Out]#        [ 3.40816327],
#[Out]#        [ 3.65306122],
#[Out]#        [ 3.89795918],
#[Out]#        [ 4.14285714],
#[Out]#        [ 4.3877551 ],
#[Out]#        [ 4.63265306],
#[Out]#        [ 4.87755102],
#[Out]#        [ 5.12244898],
#[Out]#        [ 5.36734694],
#[Out]#        [ 5.6122449 ],
#[Out]#        [ 5.85714286],
#[Out]#        [ 6.10204082],
#[Out]#        [ 6.34693878],
#[Out]#        [ 6.59183673],
#[Out]#        [ 6.83673469],
#[Out]#        [ 7.08163265],
#[Out]#        [ 7.32653061],
#[Out]#        [ 7.57142857],
#[Out]#        [ 7.81632653],
#[Out]#        [ 8.06122449],
#[Out]#        [ 8.30612245],
#[Out]#        [ 8.55102041],
#[Out]#        [ 8.79591837],
#[Out]#        [ 9.04081633],
#[Out]#        [ 9.28571429],
#[Out]#        [ 9.53061224],
#[Out]#        [ 9.7755102 ],
#[Out]#        [10.02040816],
#[Out]#        [10.26530612],
#[Out]#        [10.51020408],
#[Out]#        [10.75510204],
#[Out]#        [11.        ]])
yfit
#[Out]# array([-2.88096733, -2.39664326, -1.9123192 , -1.42799513, -0.94367106,
#[Out]#        -0.459347  ,  0.02497707,  0.50930113,  0.9936252 ,  1.47794926,
#[Out]#         1.96227333,  2.44659739,  2.93092146,  3.41524552,  3.89956959,
#[Out]#         4.38389366,  4.86821772,  5.35254179,  5.83686585,  6.32118992,
#[Out]#         6.80551398,  7.28983805,  7.77416211,  8.25848618,  8.74281024,
#[Out]#         9.22713431,  9.71145837, 10.19578244, 10.68010651, 11.16443057,
#[Out]#        11.64875464, 12.1330787 , 12.61740277, 13.10172683, 13.5860509 ,
#[Out]#        14.07037496, 14.55469903, 15.03902309, 15.52334716, 16.00767122,
#[Out]#        16.49199529, 16.97631936, 17.46064342, 17.94496749, 18.42929155,
#[Out]#        18.91361562, 19.39793968, 19.88226375, 20.36658781, 20.85091188])
xfit
#[Out]# array([[-1.        ],
#[Out]#        [-0.75510204],
#[Out]#        [-0.51020408],
#[Out]#        [-0.26530612],
#[Out]#        [-0.02040816],
#[Out]#        [ 0.2244898 ],
#[Out]#        [ 0.46938776],
#[Out]#        [ 0.71428571],
#[Out]#        [ 0.95918367],
#[Out]#        [ 1.20408163],
#[Out]#        [ 1.44897959],
#[Out]#        [ 1.69387755],
#[Out]#        [ 1.93877551],
#[Out]#        [ 2.18367347],
#[Out]#        [ 2.42857143],
#[Out]#        [ 2.67346939],
#[Out]#        [ 2.91836735],
#[Out]#        [ 3.16326531],
#[Out]#        [ 3.40816327],
#[Out]#        [ 3.65306122],
#[Out]#        [ 3.89795918],
#[Out]#        [ 4.14285714],
#[Out]#        [ 4.3877551 ],
#[Out]#        [ 4.63265306],
#[Out]#        [ 4.87755102],
#[Out]#        [ 5.12244898],
#[Out]#        [ 5.36734694],
#[Out]#        [ 5.6122449 ],
#[Out]#        [ 5.85714286],
#[Out]#        [ 6.10204082],
#[Out]#        [ 6.34693878],
#[Out]#        [ 6.59183673],
#[Out]#        [ 6.83673469],
#[Out]#        [ 7.08163265],
#[Out]#        [ 7.32653061],
#[Out]#        [ 7.57142857],
#[Out]#        [ 7.81632653],
#[Out]#        [ 8.06122449],
#[Out]#        [ 8.30612245],
#[Out]#        [ 8.55102041],
#[Out]#        [ 8.79591837],
#[Out]#        [ 9.04081633],
#[Out]#        [ 9.28571429],
#[Out]#        [ 9.53061224],
#[Out]#        [ 9.7755102 ],
#[Out]#        [10.02040816],
#[Out]#        [10.26530612],
#[Out]#        [10.51020408],
#[Out]#        [10.75510204],
#[Out]#        [11.        ]])
Xfit = xfit[:,np.newaxis]
Xfit
#[Out]# array([[[-1.        ]],
#[Out]# 
#[Out]#        [[-0.75510204]],
#[Out]# 
#[Out]#        [[-0.51020408]],
#[Out]# 
#[Out]#        [[-0.26530612]],
#[Out]# 
#[Out]#        [[-0.02040816]],
#[Out]# 
#[Out]#        [[ 0.2244898 ]],
#[Out]# 
#[Out]#        [[ 0.46938776]],
#[Out]# 
#[Out]#        [[ 0.71428571]],
#[Out]# 
#[Out]#        [[ 0.95918367]],
#[Out]# 
#[Out]#        [[ 1.20408163]],
#[Out]# 
#[Out]#        [[ 1.44897959]],
#[Out]# 
#[Out]#        [[ 1.69387755]],
#[Out]# 
#[Out]#        [[ 1.93877551]],
#[Out]# 
#[Out]#        [[ 2.18367347]],
#[Out]# 
#[Out]#        [[ 2.42857143]],
#[Out]# 
#[Out]#        [[ 2.67346939]],
#[Out]# 
#[Out]#        [[ 2.91836735]],
#[Out]# 
#[Out]#        [[ 3.16326531]],
#[Out]# 
#[Out]#        [[ 3.40816327]],
#[Out]# 
#[Out]#        [[ 3.65306122]],
#[Out]# 
#[Out]#        [[ 3.89795918]],
#[Out]# 
#[Out]#        [[ 4.14285714]],
#[Out]# 
#[Out]#        [[ 4.3877551 ]],
#[Out]# 
#[Out]#        [[ 4.63265306]],
#[Out]# 
#[Out]#        [[ 4.87755102]],
#[Out]# 
#[Out]#        [[ 5.12244898]],
#[Out]# 
#[Out]#        [[ 5.36734694]],
#[Out]# 
#[Out]#        [[ 5.6122449 ]],
#[Out]# 
#[Out]#        [[ 5.85714286]],
#[Out]# 
#[Out]#        [[ 6.10204082]],
#[Out]# 
#[Out]#        [[ 6.34693878]],
#[Out]# 
#[Out]#        [[ 6.59183673]],
#[Out]# 
#[Out]#        [[ 6.83673469]],
#[Out]# 
#[Out]#        [[ 7.08163265]],
#[Out]# 
#[Out]#        [[ 7.32653061]],
#[Out]# 
#[Out]#        [[ 7.57142857]],
#[Out]# 
#[Out]#        [[ 7.81632653]],
#[Out]# 
#[Out]#        [[ 8.06122449]],
#[Out]# 
#[Out]#        [[ 8.30612245]],
#[Out]# 
#[Out]#        [[ 8.55102041]],
#[Out]# 
#[Out]#        [[ 8.79591837]],
#[Out]# 
#[Out]#        [[ 9.04081633]],
#[Out]# 
#[Out]#        [[ 9.28571429]],
#[Out]# 
#[Out]#        [[ 9.53061224]],
#[Out]# 
#[Out]#        [[ 9.7755102 ]],
#[Out]# 
#[Out]#        [[10.02040816]],
#[Out]# 
#[Out]#        [[10.26530612]],
#[Out]# 
#[Out]#        [[10.51020408]],
#[Out]# 
#[Out]#        [[10.75510204]],
#[Out]# 
#[Out]#        [[11.        ]]])
xfit
#[Out]# array([[-1.        ],
#[Out]#        [-0.75510204],
#[Out]#        [-0.51020408],
#[Out]#        [-0.26530612],
#[Out]#        [-0.02040816],
#[Out]#        [ 0.2244898 ],
#[Out]#        [ 0.46938776],
#[Out]#        [ 0.71428571],
#[Out]#        [ 0.95918367],
#[Out]#        [ 1.20408163],
#[Out]#        [ 1.44897959],
#[Out]#        [ 1.69387755],
#[Out]#        [ 1.93877551],
#[Out]#        [ 2.18367347],
#[Out]#        [ 2.42857143],
#[Out]#        [ 2.67346939],
#[Out]#        [ 2.91836735],
#[Out]#        [ 3.16326531],
#[Out]#        [ 3.40816327],
#[Out]#        [ 3.65306122],
#[Out]#        [ 3.89795918],
#[Out]#        [ 4.14285714],
#[Out]#        [ 4.3877551 ],
#[Out]#        [ 4.63265306],
#[Out]#        [ 4.87755102],
#[Out]#        [ 5.12244898],
#[Out]#        [ 5.36734694],
#[Out]#        [ 5.6122449 ],
#[Out]#        [ 5.85714286],
#[Out]#        [ 6.10204082],
#[Out]#        [ 6.34693878],
#[Out]#        [ 6.59183673],
#[Out]#        [ 6.83673469],
#[Out]#        [ 7.08163265],
#[Out]#        [ 7.32653061],
#[Out]#        [ 7.57142857],
#[Out]#        [ 7.81632653],
#[Out]#        [ 8.06122449],
#[Out]#        [ 8.30612245],
#[Out]#        [ 8.55102041],
#[Out]#        [ 8.79591837],
#[Out]#        [ 9.04081633],
#[Out]#        [ 9.28571429],
#[Out]#        [ 9.53061224],
#[Out]#        [ 9.7755102 ],
#[Out]#        [10.02040816],
#[Out]#        [10.26530612],
#[Out]#        [10.51020408],
#[Out]#        [10.75510204],
#[Out]#        [11.        ]])
plt.scatter(x,y)
#[Out]# <matplotlib.collections.PathCollection at 0x20df7b63b70>
plt.plot(xfit,yfit)
#[Out]# [<matplotlib.lines.Line2D at 0x20df7b78da0>]
from sklearn.cross_validation import train_test_split
xtrain,xtest,ytrain,ytest = train_test_split(x_data,y_data,random_state=10)
from sklearn.naive_bayes import GaussianNB
model = GaussianNB()
model.fit(xtrain,ytrain)
model = GaussianNB()
model.fit(xtrain,ytrain)
xtrain
#[Out]#     sepal_length sepal_width  petal_length  petal_width
#[Out]# 119          6.0         2.2           5.0          1.5
#[Out]# 103          6.3         2.9           5.6          1.8
#[Out]# 26           5.0         3.4           1.6          0.4
#[Out]# 43           5.0         3.5           1.6          0.6
#[Out]# 60           5.0         2.0           3.5          1.0
#[Out]# 41           4.5         2.3           1.3          0.3
#[Out]# 49           5.0         3.3           1.4          0.2
#[Out]# 32           5.2         4.1           1.5          0.1
#[Out]# 52           6.9         3.1           4.9          1.5
#[Out]# 96           5.7         2.9           4.2          1.3
#[Out]# 70           5.9         3.2           4.8          1.8
#[Out]# 110          6.5         3.2           5.1          2.0
#[Out]# 124          6.7         3.3           5.7          2.1
#[Out]# 127          6.1         3.0           4.9          1.8
#[Out]# 106          4.9         2.5           4.5          1.7
#[Out]# 55           5.7         2.8           4.5          1.3
#[Out]# 78           6.0         2.9           4.5          1.5
#[Out]# 51           6.4         3.2           4.5          1.5
#[Out]# 14           5.8         4.0           1.2          0.2
#[Out]# 48           5.3         3.7           1.5          0.2
#[Out]# 147          6.5         3.0           5.2          2.0
#[Out]# 20           5.4         3.4           1.7          0.2
#[Out]# 138          6.0         3.0           4.8          1.8
#[Out]# 29           4.7         3.2           1.6          0.2
#[Out]# 3            4.6         3.1           1.5          0.2
#[Out]# 134          6.1         2.6           5.6          1.4
#[Out]# 99           5.7         2.8           4.1          1.3
#[Out]# 141          6.9         3.1           5.1          2.3
#[Out]# 37           4.9         3.1           1.5          0.1
#[Out]# 140          6.7         3.1           5.6          2.4
#[Out]# ..           ...         ...           ...          ...
#[Out]# 86           6.7         3.1           4.7          1.5
#[Out]# 92           5.8         2.6           4.0          1.2
#[Out]# 126          6.2         2.8           4.8          1.8
#[Out]# 25           5.0         3.0           1.6          0.2
#[Out]# 139          6.9         3.1           5.4          2.1
#[Out]# 13           4.3         3.0           1.1          0.1
#[Out]# 69           5.6         2.5           3.9          1.1
#[Out]# 77           6.7         3.0           5.0          1.7
#[Out]# 136          6.3         3.4           5.6          2.4
#[Out]# 137          6.4         3.1           5.5          1.8
#[Out]# 33           5.5         4.2           1.4          0.2
#[Out]# 62           6.0         2.2           4.0          1.0
#[Out]# 122          7.7         2.8           6.7          2.0
#[Out]# 107          7.3         2.9           6.3          1.8
#[Out]# 88           5.6         3.0           4.1          1.3
#[Out]# 54           6.5         2.8           4.6          1.5
#[Out]# 100          6.3         3.3           6.0          2.5
#[Out]# 16           5.4         3.9           1.3          0.4
#[Out]# 115          6.4         3.2           5.3          2.3
#[Out]# 40           5.0         3.5           1.3          0.3
#[Out]# 0            5.1         3.5           1.4          0.2
#[Out]# 73           6.1         2.8           4.7          1.2
#[Out]# 8            4.4         2.9           1.4          0.2
#[Out]# 146          6.3         2.5           5.0          1.9
#[Out]# 123          6.3         2.7           4.9          1.8
#[Out]# 113          5.7         2.5           5.0          2.0
#[Out]# 64           5.6         2.9           3.6          1.3
#[Out]# 15           5.7         4.4           1.5          0.4
#[Out]# 125          7.2         3.2           6.0          1.8
#[Out]# 9            4.9         3.1           1.5          0.1
#[Out]# 
#[Out]# [113 rows x 4 columns]
ytrain
#[Out]# 119     Iris-virginica
#[Out]# 103     Iris-virginica
#[Out]# 26         Iris-setosa
#[Out]# 43         Iris-setosa
#[Out]# 60     Iris-versicolor
#[Out]# 41         Iris-setosa
#[Out]# 49         Iris-setosa
#[Out]# 32         Iris-setosa
#[Out]# 52     Iris-versicolor
#[Out]# 96     Iris-versicolor
#[Out]# 70     Iris-versicolor
#[Out]# 110     Iris-virginica
#[Out]# 124     Iris-virginica
#[Out]# 127     Iris-virginica
#[Out]# 106     Iris-virginica
#[Out]# 55     Iris-versicolor
#[Out]# 78     Iris-versicolor
#[Out]# 51     Iris-versicolor
#[Out]# 14         Iris-setosa
#[Out]# 48         Iris-setosa
#[Out]# 147     Iris-virginica
#[Out]# 20         Iris-setosa
#[Out]# 138     Iris-virginica
#[Out]# 29         Iris-setosa
#[Out]# 3          Iris-setosa
#[Out]# 134     Iris-virginica
#[Out]# 99     Iris-versicolor
#[Out]# 141     Iris-virginica
#[Out]# 37         Iris-setosa
#[Out]# 140     Iris-virginica
#[Out]#             ...       
#[Out]# 86     Iris-versicolor
#[Out]# 92     Iris-versicolor
#[Out]# 126     Iris-virginica
#[Out]# 25         Iris-setosa
#[Out]# 139     Iris-virginica
#[Out]# 13         Iris-setosa
#[Out]# 69     Iris-versicolor
#[Out]# 77     Iris-versicolor
#[Out]# 136     Iris-virginica
#[Out]# 137     Iris-virginica
#[Out]# 33         Iris-setosa
#[Out]# 62     Iris-versicolor
#[Out]# 122     Iris-virginica
#[Out]# 107     Iris-virginica
#[Out]# 88     Iris-versicolor
#[Out]# 54     Iris-versicolor
#[Out]# 100     Iris-virginica
#[Out]# 16         Iris-setosa
#[Out]# 115     Iris-virginica
#[Out]# 40         Iris-setosa
#[Out]# 0          Iris-setosa
#[Out]# 73     Iris-versicolor
#[Out]# 8          Iris-setosa
#[Out]# 146     Iris-virginica
#[Out]# 123     Iris-virginica
#[Out]# 113     Iris-virginica
#[Out]# 64     Iris-versicolor
#[Out]# 15         Iris-setosa
#[Out]# 125     Iris-virginica
#[Out]# 9          Iris-setosa
#[Out]# Name: specie, Length: 113, dtype: object
x_data
#[Out]#                                           sepal_length  \
#[Out]# 0                                                  5.1   
#[Out]# 1                                                  4.9   
#[Out]# 2                                                  4.7   
#[Out]# 3                                                  4.6   
#[Out]# 4                                                  5.0   
#[Out]# 5                                                  5.4   
#[Out]# 6                                                  4.6   
#[Out]# 7                                                  5.0   
#[Out]# 8                                                  4.4   
#[Out]# 9                                                  4.9   
#[Out]# 10                                                 5.4   
#[Out]# 11                                                 4.8   
#[Out]# 12                                                 4.8   
#[Out]# 13                                                 4.3   
#[Out]# 14                                                 5.8   
#[Out]# 15                                                 5.7   
#[Out]# 16                                                 5.4   
#[Out]# 17                                                 5.1   
#[Out]# 18                                                 5.7   
#[Out]# 19                                                 5.1   
#[Out]# 20                                                 5.4   
#[Out]# 21                                                 5.1   
#[Out]# 22                                                 4.6   
#[Out]# 23                                                 5.1   
#[Out]# 24                                                 4.8   
#[Out]# 25                                                 5.0   
#[Out]# 26                                                 5.0   
#[Out]# 27                                                 5.2   
#[Out]# 28                                                 5.2   
#[Out]# 29                                                 4.7   
#[Out]# ..                                                 ...   
#[Out]# 121                                                5.6   
#[Out]# 122                                                7.7   
#[Out]# 123                                                6.3   
#[Out]# 124                                                6.7   
#[Out]# 125                                                7.2   
#[Out]# 126                                                6.2   
#[Out]# 127                                                6.1   
#[Out]# 128                                                6.4   
#[Out]# 129                                                7.2   
#[Out]# 130                                                7.4   
#[Out]# 131                                                7.9   
#[Out]# 132                                                6.4   
#[Out]# 133                                                6.3   
#[Out]# 134                                                6.1   
#[Out]# 135                                                7.7   
#[Out]# 136                                                6.3   
#[Out]# 137                                                6.4   
#[Out]# 138                                                6.0   
#[Out]# 139                                                6.9   
#[Out]# 140                                                6.7   
#[Out]# 141                                                6.9   
#[Out]# 142                                                5.8   
#[Out]# 143                                                6.8   
#[Out]# 144                                                6.7   
#[Out]# 145                                                6.7   
#[Out]# 146                                                6.3   
#[Out]# 147                                                6.5   
#[Out]# 148                                                6.2   
#[Out]# 149                                                5.9   
#[Out]# 150  该数据集有3个类virginica，versicolor和setosa，每类50个样本；每个...   
#[Out]# 
#[Out]#                                    sepal_width  petal_length  petal_width  
#[Out]# 0                                          3.5           1.4          0.2  
#[Out]# 1                                          3.0           1.4          0.2  
#[Out]# 2                                          3.2           1.3          0.2  
#[Out]# 3                                          3.1           1.5          0.2  
#[Out]# 4                                          3.6           1.4          0.2  
#[Out]# 5                                          3.9           1.7          0.4  
#[Out]# 6                                          3.4           1.4          0.3  
#[Out]# 7                                          3.4           1.5          0.2  
#[Out]# 8                                          2.9           1.4          0.2  
#[Out]# 9                                          3.1           1.5          0.1  
#[Out]# 10                                         3.7           1.5          0.2  
#[Out]# 11                                         3.4           1.6          0.2  
#[Out]# 12                                         3.0           1.4          0.1  
#[Out]# 13                                         3.0           1.1          0.1  
#[Out]# 14                                         4.0           1.2          0.2  
#[Out]# 15                                         4.4           1.5          0.4  
#[Out]# 16                                         3.9           1.3          0.4  
#[Out]# 17                                         3.5           1.4          0.3  
#[Out]# 18                                         3.8           1.7          0.3  
#[Out]# 19                                         3.8           1.5          0.3  
#[Out]# 20                                         3.4           1.7          0.2  
#[Out]# 21                                         3.7           1.5          0.4  
#[Out]# 22                                         3.6           1.0          0.2  
#[Out]# 23                                         3.3           1.7          0.5  
#[Out]# 24                                         3.4           1.9          0.2  
#[Out]# 25                                         3.0           1.6          0.2  
#[Out]# 26                                         3.4           1.6          0.4  
#[Out]# 27                                         3.5           1.5          0.2  
#[Out]# 28                                         3.4           1.4          0.2  
#[Out]# 29                                         3.2           1.6          0.2  
#[Out]# ..                                         ...           ...          ...  
#[Out]# 121                                        2.8           4.9          2.0  
#[Out]# 122                                        2.8           6.7          2.0  
#[Out]# 123                                        2.7           4.9          1.8  
#[Out]# 124                                        3.3           5.7          2.1  
#[Out]# 125                                        3.2           6.0          1.8  
#[Out]# 126                                        2.8           4.8          1.8  
#[Out]# 127                                        3.0           4.9          1.8  
#[Out]# 128                                        2.8           5.6          2.1  
#[Out]# 129                                        3.0           5.8          1.6  
#[Out]# 130                                        2.8           6.1          1.9  
#[Out]# 131                                        3.8           6.4          2.0  
#[Out]# 132                                        2.8           5.6          2.2  
#[Out]# 133                                        2.8           5.1          1.5  
#[Out]# 134                                        2.6           5.6          1.4  
#[Out]# 135                                        3.0           6.1          2.3  
#[Out]# 136                                        3.4           5.6          2.4  
#[Out]# 137                                        3.1           5.5          1.8  
#[Out]# 138                                        3.0           4.8          1.8  
#[Out]# 139                                        3.1           5.4          2.1  
#[Out]# 140                                        3.1           5.6          2.4  
#[Out]# 141                                        3.1           5.1          2.3  
#[Out]# 142                                        2.7           5.1          1.9  
#[Out]# 143                                        3.2           5.9          2.3  
#[Out]# 144                                        3.3           5.7          2.5  
#[Out]# 145                                        3.0           5.2          2.3  
#[Out]# 146                                        2.5           5.0          1.9  
#[Out]# 147                                        3.0           5.2          2.0  
#[Out]# 148                                        3.4           5.4          2.3  
#[Out]# 149                                        3.0           5.1          1.8  
#[Out]# 150  萼片长，萼片宽，花瓣长，花瓣宽；virginica和versicolor有很多重叠           NaN          NaN  
#[Out]# 
#[Out]# [151 rows x 4 columns]
x_data
#[Out]#                                           sepal_length  \
#[Out]# 0                                                  5.1   
#[Out]# 1                                                  4.9   
#[Out]# 2                                                  4.7   
#[Out]# 3                                                  4.6   
#[Out]# 4                                                  5.0   
#[Out]# 5                                                  5.4   
#[Out]# 6                                                  4.6   
#[Out]# 7                                                  5.0   
#[Out]# 8                                                  4.4   
#[Out]# 9                                                  4.9   
#[Out]# 10                                                 5.4   
#[Out]# 11                                                 4.8   
#[Out]# 12                                                 4.8   
#[Out]# 13                                                 4.3   
#[Out]# 14                                                 5.8   
#[Out]# 15                                                 5.7   
#[Out]# 16                                                 5.4   
#[Out]# 17                                                 5.1   
#[Out]# 18                                                 5.7   
#[Out]# 19                                                 5.1   
#[Out]# 20                                                 5.4   
#[Out]# 21                                                 5.1   
#[Out]# 22                                                 4.6   
#[Out]# 23                                                 5.1   
#[Out]# 24                                                 4.8   
#[Out]# 25                                                 5.0   
#[Out]# 26                                                 5.0   
#[Out]# 27                                                 5.2   
#[Out]# 28                                                 5.2   
#[Out]# 29                                                 4.7   
#[Out]# ..                                                 ...   
#[Out]# 121                                                5.6   
#[Out]# 122                                                7.7   
#[Out]# 123                                                6.3   
#[Out]# 124                                                6.7   
#[Out]# 125                                                7.2   
#[Out]# 126                                                6.2   
#[Out]# 127                                                6.1   
#[Out]# 128                                                6.4   
#[Out]# 129                                                7.2   
#[Out]# 130                                                7.4   
#[Out]# 131                                                7.9   
#[Out]# 132                                                6.4   
#[Out]# 133                                                6.3   
#[Out]# 134                                                6.1   
#[Out]# 135                                                7.7   
#[Out]# 136                                                6.3   
#[Out]# 137                                                6.4   
#[Out]# 138                                                6.0   
#[Out]# 139                                                6.9   
#[Out]# 140                                                6.7   
#[Out]# 141                                                6.9   
#[Out]# 142                                                5.8   
#[Out]# 143                                                6.8   
#[Out]# 144                                                6.7   
#[Out]# 145                                                6.7   
#[Out]# 146                                                6.3   
#[Out]# 147                                                6.5   
#[Out]# 148                                                6.2   
#[Out]# 149                                                5.9   
#[Out]# 150  该数据集有3个类virginica，versicolor和setosa，每类50个样本；每个...   
#[Out]# 
#[Out]#                                    sepal_width  petal_length  petal_width  
#[Out]# 0                                          3.5           1.4          0.2  
#[Out]# 1                                          3.0           1.4          0.2  
#[Out]# 2                                          3.2           1.3          0.2  
#[Out]# 3                                          3.1           1.5          0.2  
#[Out]# 4                                          3.6           1.4          0.2  
#[Out]# 5                                          3.9           1.7          0.4  
#[Out]# 6                                          3.4           1.4          0.3  
#[Out]# 7                                          3.4           1.5          0.2  
#[Out]# 8                                          2.9           1.4          0.2  
#[Out]# 9                                          3.1           1.5          0.1  
#[Out]# 10                                         3.7           1.5          0.2  
#[Out]# 11                                         3.4           1.6          0.2  
#[Out]# 12                                         3.0           1.4          0.1  
#[Out]# 13                                         3.0           1.1          0.1  
#[Out]# 14                                         4.0           1.2          0.2  
#[Out]# 15                                         4.4           1.5          0.4  
#[Out]# 16                                         3.9           1.3          0.4  
#[Out]# 17                                         3.5           1.4          0.3  
#[Out]# 18                                         3.8           1.7          0.3  
#[Out]# 19                                         3.8           1.5          0.3  
#[Out]# 20                                         3.4           1.7          0.2  
#[Out]# 21                                         3.7           1.5          0.4  
#[Out]# 22                                         3.6           1.0          0.2  
#[Out]# 23                                         3.3           1.7          0.5  
#[Out]# 24                                         3.4           1.9          0.2  
#[Out]# 25                                         3.0           1.6          0.2  
#[Out]# 26                                         3.4           1.6          0.4  
#[Out]# 27                                         3.5           1.5          0.2  
#[Out]# 28                                         3.4           1.4          0.2  
#[Out]# 29                                         3.2           1.6          0.2  
#[Out]# ..                                         ...           ...          ...  
#[Out]# 121                                        2.8           4.9          2.0  
#[Out]# 122                                        2.8           6.7          2.0  
#[Out]# 123                                        2.7           4.9          1.8  
#[Out]# 124                                        3.3           5.7          2.1  
#[Out]# 125                                        3.2           6.0          1.8  
#[Out]# 126                                        2.8           4.8          1.8  
#[Out]# 127                                        3.0           4.9          1.8  
#[Out]# 128                                        2.8           5.6          2.1  
#[Out]# 129                                        3.0           5.8          1.6  
#[Out]# 130                                        2.8           6.1          1.9  
#[Out]# 131                                        3.8           6.4          2.0  
#[Out]# 132                                        2.8           5.6          2.2  
#[Out]# 133                                        2.8           5.1          1.5  
#[Out]# 134                                        2.6           5.6          1.4  
#[Out]# 135                                        3.0           6.1          2.3  
#[Out]# 136                                        3.4           5.6          2.4  
#[Out]# 137                                        3.1           5.5          1.8  
#[Out]# 138                                        3.0           4.8          1.8  
#[Out]# 139                                        3.1           5.4          2.1  
#[Out]# 140                                        3.1           5.6          2.4  
#[Out]# 141                                        3.1           5.1          2.3  
#[Out]# 142                                        2.7           5.1          1.9  
#[Out]# 143                                        3.2           5.9          2.3  
#[Out]# 144                                        3.3           5.7          2.5  
#[Out]# 145                                        3.0           5.2          2.3  
#[Out]# 146                                        2.5           5.0          1.9  
#[Out]# 147                                        3.0           5.2          2.0  
#[Out]# 148                                        3.4           5.4          2.3  
#[Out]# 149                                        3.0           5.1          1.8  
#[Out]# 150  萼片长，萼片宽，花瓣长，花瓣宽；virginica和versicolor有很多重叠           NaN          NaN  
#[Out]# 
#[Out]# [151 rows x 4 columns]
y_data
#[Out]# 0         Iris-setosa
#[Out]# 1         Iris-setosa
#[Out]# 2         Iris-setosa
#[Out]# 3         Iris-setosa
#[Out]# 4         Iris-setosa
#[Out]# 5         Iris-setosa
#[Out]# 6         Iris-setosa
#[Out]# 7         Iris-setosa
#[Out]# 8         Iris-setosa
#[Out]# 9         Iris-setosa
#[Out]# 10        Iris-setosa
#[Out]# 11        Iris-setosa
#[Out]# 12        Iris-setosa
#[Out]# 13        Iris-setosa
#[Out]# 14        Iris-setosa
#[Out]# 15        Iris-setosa
#[Out]# 16        Iris-setosa
#[Out]# 17        Iris-setosa
#[Out]# 18        Iris-setosa
#[Out]# 19        Iris-setosa
#[Out]# 20        Iris-setosa
#[Out]# 21        Iris-setosa
#[Out]# 22        Iris-setosa
#[Out]# 23        Iris-setosa
#[Out]# 24        Iris-setosa
#[Out]# 25        Iris-setosa
#[Out]# 26        Iris-setosa
#[Out]# 27        Iris-setosa
#[Out]# 28        Iris-setosa
#[Out]# 29        Iris-setosa
#[Out]#             ...      
#[Out]# 121    Iris-virginica
#[Out]# 122    Iris-virginica
#[Out]# 123    Iris-virginica
#[Out]# 124    Iris-virginica
#[Out]# 125    Iris-virginica
#[Out]# 126    Iris-virginica
#[Out]# 127    Iris-virginica
#[Out]# 128    Iris-virginica
#[Out]# 129    Iris-virginica
#[Out]# 130    Iris-virginica
#[Out]# 131    Iris-virginica
#[Out]# 132    Iris-virginica
#[Out]# 133    Iris-virginica
#[Out]# 134    Iris-virginica
#[Out]# 135    Iris-virginica
#[Out]# 136    Iris-virginica
#[Out]# 137    Iris-virginica
#[Out]# 138    Iris-virginica
#[Out]# 139    Iris-virginica
#[Out]# 140    Iris-virginica
#[Out]# 141    Iris-virginica
#[Out]# 142    Iris-virginica
#[Out]# 143    Iris-virginica
#[Out]# 144    Iris-virginica
#[Out]# 145    Iris-virginica
#[Out]# 146    Iris-virginica
#[Out]# 147    Iris-virginica
#[Out]# 148    Iris-virginica
#[Out]# 149    Iris-virginica
#[Out]# 150               NaN
#[Out]# Name: specie, Length: 151, dtype: object
type(x_data)
#[Out]# pandas.core.frame.DataFrame
x_data = x_data.iloc[:151,:]
x_data
#[Out]#                                           sepal_length  \
#[Out]# 0                                                  5.1   
#[Out]# 1                                                  4.9   
#[Out]# 2                                                  4.7   
#[Out]# 3                                                  4.6   
#[Out]# 4                                                  5.0   
#[Out]# 5                                                  5.4   
#[Out]# 6                                                  4.6   
#[Out]# 7                                                  5.0   
#[Out]# 8                                                  4.4   
#[Out]# 9                                                  4.9   
#[Out]# 10                                                 5.4   
#[Out]# 11                                                 4.8   
#[Out]# 12                                                 4.8   
#[Out]# 13                                                 4.3   
#[Out]# 14                                                 5.8   
#[Out]# 15                                                 5.7   
#[Out]# 16                                                 5.4   
#[Out]# 17                                                 5.1   
#[Out]# 18                                                 5.7   
#[Out]# 19                                                 5.1   
#[Out]# 20                                                 5.4   
#[Out]# 21                                                 5.1   
#[Out]# 22                                                 4.6   
#[Out]# 23                                                 5.1   
#[Out]# 24                                                 4.8   
#[Out]# 25                                                 5.0   
#[Out]# 26                                                 5.0   
#[Out]# 27                                                 5.2   
#[Out]# 28                                                 5.2   
#[Out]# 29                                                 4.7   
#[Out]# ..                                                 ...   
#[Out]# 121                                                5.6   
#[Out]# 122                                                7.7   
#[Out]# 123                                                6.3   
#[Out]# 124                                                6.7   
#[Out]# 125                                                7.2   
#[Out]# 126                                                6.2   
#[Out]# 127                                                6.1   
#[Out]# 128                                                6.4   
#[Out]# 129                                                7.2   
#[Out]# 130                                                7.4   
#[Out]# 131                                                7.9   
#[Out]# 132                                                6.4   
#[Out]# 133                                                6.3   
#[Out]# 134                                                6.1   
#[Out]# 135                                                7.7   
#[Out]# 136                                                6.3   
#[Out]# 137                                                6.4   
#[Out]# 138                                                6.0   
#[Out]# 139                                                6.9   
#[Out]# 140                                                6.7   
#[Out]# 141                                                6.9   
#[Out]# 142                                                5.8   
#[Out]# 143                                                6.8   
#[Out]# 144                                                6.7   
#[Out]# 145                                                6.7   
#[Out]# 146                                                6.3   
#[Out]# 147                                                6.5   
#[Out]# 148                                                6.2   
#[Out]# 149                                                5.9   
#[Out]# 150  该数据集有3个类virginica，versicolor和setosa，每类50个样本；每个...   
#[Out]# 
#[Out]#                                    sepal_width  petal_length  petal_width  
#[Out]# 0                                          3.5           1.4          0.2  
#[Out]# 1                                          3.0           1.4          0.2  
#[Out]# 2                                          3.2           1.3          0.2  
#[Out]# 3                                          3.1           1.5          0.2  
#[Out]# 4                                          3.6           1.4          0.2  
#[Out]# 5                                          3.9           1.7          0.4  
#[Out]# 6                                          3.4           1.4          0.3  
#[Out]# 7                                          3.4           1.5          0.2  
#[Out]# 8                                          2.9           1.4          0.2  
#[Out]# 9                                          3.1           1.5          0.1  
#[Out]# 10                                         3.7           1.5          0.2  
#[Out]# 11                                         3.4           1.6          0.2  
#[Out]# 12                                         3.0           1.4          0.1  
#[Out]# 13                                         3.0           1.1          0.1  
#[Out]# 14                                         4.0           1.2          0.2  
#[Out]# 15                                         4.4           1.5          0.4  
#[Out]# 16                                         3.9           1.3          0.4  
#[Out]# 17                                         3.5           1.4          0.3  
#[Out]# 18                                         3.8           1.7          0.3  
#[Out]# 19                                         3.8           1.5          0.3  
#[Out]# 20                                         3.4           1.7          0.2  
#[Out]# 21                                         3.7           1.5          0.4  
#[Out]# 22                                         3.6           1.0          0.2  
#[Out]# 23                                         3.3           1.7          0.5  
#[Out]# 24                                         3.4           1.9          0.2  
#[Out]# 25                                         3.0           1.6          0.2  
#[Out]# 26                                         3.4           1.6          0.4  
#[Out]# 27                                         3.5           1.5          0.2  
#[Out]# 28                                         3.4           1.4          0.2  
#[Out]# 29                                         3.2           1.6          0.2  
#[Out]# ..                                         ...           ...          ...  
#[Out]# 121                                        2.8           4.9          2.0  
#[Out]# 122                                        2.8           6.7          2.0  
#[Out]# 123                                        2.7           4.9          1.8  
#[Out]# 124                                        3.3           5.7          2.1  
#[Out]# 125                                        3.2           6.0          1.8  
#[Out]# 126                                        2.8           4.8          1.8  
#[Out]# 127                                        3.0           4.9          1.8  
#[Out]# 128                                        2.8           5.6          2.1  
#[Out]# 129                                        3.0           5.8          1.6  
#[Out]# 130                                        2.8           6.1          1.9  
#[Out]# 131                                        3.8           6.4          2.0  
#[Out]# 132                                        2.8           5.6          2.2  
#[Out]# 133                                        2.8           5.1          1.5  
#[Out]# 134                                        2.6           5.6          1.4  
#[Out]# 135                                        3.0           6.1          2.3  
#[Out]# 136                                        3.4           5.6          2.4  
#[Out]# 137                                        3.1           5.5          1.8  
#[Out]# 138                                        3.0           4.8          1.8  
#[Out]# 139                                        3.1           5.4          2.1  
#[Out]# 140                                        3.1           5.6          2.4  
#[Out]# 141                                        3.1           5.1          2.3  
#[Out]# 142                                        2.7           5.1          1.9  
#[Out]# 143                                        3.2           5.9          2.3  
#[Out]# 144                                        3.3           5.7          2.5  
#[Out]# 145                                        3.0           5.2          2.3  
#[Out]# 146                                        2.5           5.0          1.9  
#[Out]# 147                                        3.0           5.2          2.0  
#[Out]# 148                                        3.4           5.4          2.3  
#[Out]# 149                                        3.0           5.1          1.8  
#[Out]# 150  萼片长，萼片宽，花瓣长，花瓣宽；virginica和versicolor有很多重叠           NaN          NaN  
#[Out]# 
#[Out]# [151 rows x 4 columns]
x_data = x_data.iloc[:150,:]
x_data
#[Out]#     sepal_length sepal_width  petal_length  petal_width
#[Out]# 0            5.1         3.5           1.4          0.2
#[Out]# 1            4.9         3.0           1.4          0.2
#[Out]# 2            4.7         3.2           1.3          0.2
#[Out]# 3            4.6         3.1           1.5          0.2
#[Out]# 4            5.0         3.6           1.4          0.2
#[Out]# 5            5.4         3.9           1.7          0.4
#[Out]# 6            4.6         3.4           1.4          0.3
#[Out]# 7            5.0         3.4           1.5          0.2
#[Out]# 8            4.4         2.9           1.4          0.2
#[Out]# 9            4.9         3.1           1.5          0.1
#[Out]# 10           5.4         3.7           1.5          0.2
#[Out]# 11           4.8         3.4           1.6          0.2
#[Out]# 12           4.8         3.0           1.4          0.1
#[Out]# 13           4.3         3.0           1.1          0.1
#[Out]# 14           5.8         4.0           1.2          0.2
#[Out]# 15           5.7         4.4           1.5          0.4
#[Out]# 16           5.4         3.9           1.3          0.4
#[Out]# 17           5.1         3.5           1.4          0.3
#[Out]# 18           5.7         3.8           1.7          0.3
#[Out]# 19           5.1         3.8           1.5          0.3
#[Out]# 20           5.4         3.4           1.7          0.2
#[Out]# 21           5.1         3.7           1.5          0.4
#[Out]# 22           4.6         3.6           1.0          0.2
#[Out]# 23           5.1         3.3           1.7          0.5
#[Out]# 24           4.8         3.4           1.9          0.2
#[Out]# 25           5.0         3.0           1.6          0.2
#[Out]# 26           5.0         3.4           1.6          0.4
#[Out]# 27           5.2         3.5           1.5          0.2
#[Out]# 28           5.2         3.4           1.4          0.2
#[Out]# 29           4.7         3.2           1.6          0.2
#[Out]# ..           ...         ...           ...          ...
#[Out]# 120          6.9         3.2           5.7          2.3
#[Out]# 121          5.6         2.8           4.9          2.0
#[Out]# 122          7.7         2.8           6.7          2.0
#[Out]# 123          6.3         2.7           4.9          1.8
#[Out]# 124          6.7         3.3           5.7          2.1
#[Out]# 125          7.2         3.2           6.0          1.8
#[Out]# 126          6.2         2.8           4.8          1.8
#[Out]# 127          6.1         3.0           4.9          1.8
#[Out]# 128          6.4         2.8           5.6          2.1
#[Out]# 129          7.2         3.0           5.8          1.6
#[Out]# 130          7.4         2.8           6.1          1.9
#[Out]# 131          7.9         3.8           6.4          2.0
#[Out]# 132          6.4         2.8           5.6          2.2
#[Out]# 133          6.3         2.8           5.1          1.5
#[Out]# 134          6.1         2.6           5.6          1.4
#[Out]# 135          7.7         3.0           6.1          2.3
#[Out]# 136          6.3         3.4           5.6          2.4
#[Out]# 137          6.4         3.1           5.5          1.8
#[Out]# 138          6.0         3.0           4.8          1.8
#[Out]# 139          6.9         3.1           5.4          2.1
#[Out]# 140          6.7         3.1           5.6          2.4
#[Out]# 141          6.9         3.1           5.1          2.3
#[Out]# 142          5.8         2.7           5.1          1.9
#[Out]# 143          6.8         3.2           5.9          2.3
#[Out]# 144          6.7         3.3           5.7          2.5
#[Out]# 145          6.7         3.0           5.2          2.3
#[Out]# 146          6.3         2.5           5.0          1.9
#[Out]# 147          6.5         3.0           5.2          2.0
#[Out]# 148          6.2         3.4           5.4          2.3
#[Out]# 149          5.9         3.0           5.1          1.8
#[Out]# 
#[Out]# [150 rows x 4 columns]
y_data = y_data.iloc[:150,:]
type(y_data)
#[Out]# pandas.core.series.Series
y_data = ydata[0:150]
y_data = y_data[0:150]
y_data
#[Out]# 0         Iris-setosa
#[Out]# 1         Iris-setosa
#[Out]# 2         Iris-setosa
#[Out]# 3         Iris-setosa
#[Out]# 4         Iris-setosa
#[Out]# 5         Iris-setosa
#[Out]# 6         Iris-setosa
#[Out]# 7         Iris-setosa
#[Out]# 8         Iris-setosa
#[Out]# 9         Iris-setosa
#[Out]# 10        Iris-setosa
#[Out]# 11        Iris-setosa
#[Out]# 12        Iris-setosa
#[Out]# 13        Iris-setosa
#[Out]# 14        Iris-setosa
#[Out]# 15        Iris-setosa
#[Out]# 16        Iris-setosa
#[Out]# 17        Iris-setosa
#[Out]# 18        Iris-setosa
#[Out]# 19        Iris-setosa
#[Out]# 20        Iris-setosa
#[Out]# 21        Iris-setosa
#[Out]# 22        Iris-setosa
#[Out]# 23        Iris-setosa
#[Out]# 24        Iris-setosa
#[Out]# 25        Iris-setosa
#[Out]# 26        Iris-setosa
#[Out]# 27        Iris-setosa
#[Out]# 28        Iris-setosa
#[Out]# 29        Iris-setosa
#[Out]#             ...      
#[Out]# 120    Iris-virginica
#[Out]# 121    Iris-virginica
#[Out]# 122    Iris-virginica
#[Out]# 123    Iris-virginica
#[Out]# 124    Iris-virginica
#[Out]# 125    Iris-virginica
#[Out]# 126    Iris-virginica
#[Out]# 127    Iris-virginica
#[Out]# 128    Iris-virginica
#[Out]# 129    Iris-virginica
#[Out]# 130    Iris-virginica
#[Out]# 131    Iris-virginica
#[Out]# 132    Iris-virginica
#[Out]# 133    Iris-virginica
#[Out]# 134    Iris-virginica
#[Out]# 135    Iris-virginica
#[Out]# 136    Iris-virginica
#[Out]# 137    Iris-virginica
#[Out]# 138    Iris-virginica
#[Out]# 139    Iris-virginica
#[Out]# 140    Iris-virginica
#[Out]# 141    Iris-virginica
#[Out]# 142    Iris-virginica
#[Out]# 143    Iris-virginica
#[Out]# 144    Iris-virginica
#[Out]# 145    Iris-virginica
#[Out]# 146    Iris-virginica
#[Out]# 147    Iris-virginica
#[Out]# 148    Iris-virginica
#[Out]# 149    Iris-virginica
#[Out]# Name: specie, Length: 150, dtype: object
xtrain,xtest,ytrain,ytest = train_test_split(x_data,y_data,random_state=10)
model = GaussianNB()
model.fit(xtrain,ytrain)
#[Out]# GaussianNB(priors=None)
y_model = model.predict(xtest)
from sklearn.metrics import accuracy_score
accuracy_score(ytest,y_model)
#[Out]# 1.0
xtest
#[Out]#     sepal_length sepal_width  petal_length  petal_width
#[Out]# 87           6.3         2.3           4.4          1.3
#[Out]# 111          6.4         2.7           5.3          1.9
#[Out]# 10           5.4         3.7           1.5          0.2
#[Out]# 91           6.1         3.0           4.6          1.4
#[Out]# 49           5.0         3.3           1.4          0.2
#[Out]# 60           5.0         2.0           3.5          1.0
#[Out]# 72           6.3         2.5           4.9          1.5
#[Out]# 67           5.8         2.7           4.1          1.0
#[Out]# 39           5.1         3.4           1.5          0.2
#[Out]# 55           5.7         2.8           4.5          1.3
#[Out]# 66           5.6         3.0           4.5          1.5
#[Out]# 142          5.8         2.7           5.1          1.9
#[Out]# 53           5.5         2.3           4.0          1.3
#[Out]# 1            4.9         3.0           1.4          0.2
#[Out]# 19           5.1         3.8           1.5          0.3
#[Out]# 112          6.8         3.0           5.5          2.1
#[Out]# 85           6.0         3.4           4.5          1.6
#[Out]# 38           4.4         3.0           1.3          0.2
#[Out]# 21           5.1         3.7           1.5          0.4
#[Out]# 35           5.0         3.2           1.2          0.2
#[Out]# 102          7.1         3.0           5.9          2.1
#[Out]# 132          6.4         2.8           5.6          2.2
#[Out]# 126          6.2         2.8           4.8          1.8
#[Out]# 24           4.8         3.4           1.9          0.2
#[Out]# 61           5.9         3.0           4.2          1.5
#[Out]# 2            4.7         3.2           1.3          0.2
#[Out]# 95           5.7         3.0           4.2          1.2
#[Out]# 90           5.5         2.6           4.4          1.2
#[Out]# 76           6.8         2.8           4.8          1.4
#[Out]# 117          7.7         3.8           6.7          2.2
#[Out]# 58           6.6         2.9           4.6          1.3
#[Out]# 97           6.2         2.9           4.3          1.3
#[Out]# 129          7.2         3.0           5.8          1.6
#[Out]# 114          5.8         2.8           5.1          2.4
#[Out]# 146          6.3         2.5           5.0          1.9
#[Out]# 47           4.6         3.2           1.4          0.2
#[Out]# 124          6.7         3.3           5.7          2.1
#[Out]# 120          6.9         3.2           5.7          2.3
ytest
#[Out]# 87     Iris-versicolor
#[Out]# 111     Iris-virginica
#[Out]# 10         Iris-setosa
#[Out]# 91     Iris-versicolor
#[Out]# 49         Iris-setosa
#[Out]# 60     Iris-versicolor
#[Out]# 72     Iris-versicolor
#[Out]# 67     Iris-versicolor
#[Out]# 39         Iris-setosa
#[Out]# 55     Iris-versicolor
#[Out]# 66     Iris-versicolor
#[Out]# 142     Iris-virginica
#[Out]# 53     Iris-versicolor
#[Out]# 1          Iris-setosa
#[Out]# 19         Iris-setosa
#[Out]# 112     Iris-virginica
#[Out]# 85     Iris-versicolor
#[Out]# 38         Iris-setosa
#[Out]# 21         Iris-setosa
#[Out]# 35         Iris-setosa
#[Out]# 102     Iris-virginica
#[Out]# 132     Iris-virginica
#[Out]# 126     Iris-virginica
#[Out]# 24         Iris-setosa
#[Out]# 61     Iris-versicolor
#[Out]# 2          Iris-setosa
#[Out]# 95     Iris-versicolor
#[Out]# 90     Iris-versicolor
#[Out]# 76     Iris-versicolor
#[Out]# 117     Iris-virginica
#[Out]# 58     Iris-versicolor
#[Out]# 97     Iris-versicolor
#[Out]# 129     Iris-virginica
#[Out]# 114     Iris-virginica
#[Out]# 146     Iris-virginica
#[Out]# 47         Iris-setosa
#[Out]# 124     Iris-virginica
#[Out]# 120     Iris-virginica
#[Out]# Name: specie, dtype: object
y_model
#[Out]# array(['Iris-versicolor', 'Iris-virginica', 'Iris-setosa',
#[Out]#        'Iris-versicolor', 'Iris-setosa', 'Iris-versicolor',
#[Out]#        'Iris-versicolor', 'Iris-versicolor', 'Iris-setosa',
#[Out]#        'Iris-versicolor', 'Iris-versicolor', 'Iris-virginica',
#[Out]#        'Iris-versicolor', 'Iris-setosa', 'Iris-setosa', 'Iris-virginica',
#[Out]#        'Iris-versicolor', 'Iris-setosa', 'Iris-setosa', 'Iris-setosa',
#[Out]#        'Iris-virginica', 'Iris-virginica', 'Iris-virginica',
#[Out]#        'Iris-setosa', 'Iris-versicolor', 'Iris-setosa', 'Iris-versicolor',
#[Out]#        'Iris-versicolor', 'Iris-versicolor', 'Iris-virginica',
#[Out]#        'Iris-versicolor', 'Iris-versicolor', 'Iris-virginica',
#[Out]#        'Iris-virginica', 'Iris-virginica', 'Iris-setosa',
#[Out]#        'Iris-virginica', 'Iris-virginica'], dtype='<U15')
from sklearn.decomposition import PCA 
model = PCA(n_components=2)
model.fit(x_data)
#[Out]# PCA(copy=True, iterated_power='auto', n_components=2, random_state=None,
#[Out]#   svd_solver='auto', tol=0.0, whiten=False)
x_2d = model.transform(x_data)
data.columns
#[Out]# Index(['sepal_length', 'sepal_width', 'petal_length', 'petal_width', 'specie'], dtype='object')
data['pca1'] = x_2d[:,0]
x_2d
#[Out]# array([[-2.68420713,  0.32660731],
#[Out]#        [-2.71539062, -0.16955685],
#[Out]#        [-2.88981954, -0.13734561],
#[Out]#        [-2.7464372 , -0.31112432],
#[Out]#        [-2.72859298,  0.33392456],
#[Out]#        [-2.27989736,  0.74778271],
#[Out]#        [-2.82089068, -0.08210451],
#[Out]#        [-2.62648199,  0.17040535],
#[Out]#        [-2.88795857, -0.57079803],
#[Out]#        [-2.67384469, -0.1066917 ],
#[Out]#        [-2.50652679,  0.65193501],
#[Out]#        [-2.61314272,  0.02152063],
#[Out]#        [-2.78743398, -0.22774019],
#[Out]#        [-3.22520045, -0.50327991],
#[Out]#        [-2.64354322,  1.1861949 ],
#[Out]#        [-2.38386932,  1.34475434],
#[Out]#        [-2.6225262 ,  0.81808967],
#[Out]#        [-2.64832273,  0.31913667],
#[Out]#        [-2.19907796,  0.87924409],
#[Out]#        [-2.58734619,  0.52047364],
#[Out]#        [-2.3105317 ,  0.39786782],
#[Out]#        [-2.54323491,  0.44003175],
#[Out]#        [-3.21585769,  0.14161557],
#[Out]#        [-2.30312854,  0.10552268],
#[Out]#        [-2.35617109, -0.03120959],
#[Out]#        [-2.50791723, -0.13905634],
#[Out]#        [-2.469056  ,  0.13788731],
#[Out]#        [-2.56239095,  0.37468456],
#[Out]#        [-2.63982127,  0.31929007],
#[Out]#        [-2.63284791, -0.19007583],
#[Out]#        [-2.58846205, -0.19739308],
#[Out]#        [-2.41007734,  0.41808001],
#[Out]#        [-2.64763667,  0.81998263],
#[Out]#        [-2.59715948,  1.10002193],
#[Out]#        [-2.67384469, -0.1066917 ],
#[Out]#        [-2.86699985,  0.0771931 ],
#[Out]#        [-2.62522846,  0.60680001],
#[Out]#        [-2.67384469, -0.1066917 ],
#[Out]#        [-2.98184266, -0.48025005],
#[Out]#        [-2.59032303,  0.23605934],
#[Out]#        [-2.77013891,  0.27105942],
#[Out]#        [-2.85221108, -0.93286537],
#[Out]#        [-2.99829644, -0.33430757],
#[Out]#        [-2.4055141 ,  0.19591726],
#[Out]#        [-2.20883295,  0.44269603],
#[Out]#        [-2.71566519, -0.24268148],
#[Out]#        [-2.53757337,  0.51036755],
#[Out]#        [-2.8403213 , -0.22057634],
#[Out]#        [-2.54268576,  0.58628103],
#[Out]#        [-2.70391231,  0.11501085],
#[Out]#        [ 1.28479459,  0.68543919],
#[Out]#        [ 0.93241075,  0.31919809],
#[Out]#        [ 1.46406132,  0.50418983],
#[Out]#        [ 0.18096721, -0.82560394],
#[Out]#        [ 1.08713449,  0.07539039],
#[Out]#        [ 0.64043675, -0.41732348],
#[Out]#        [ 1.09522371,  0.28389121],
#[Out]#        [-0.75146714, -1.00110751],
#[Out]#        [ 1.04329778,  0.22895691],
#[Out]#        [-0.01019007, -0.72057487],
#[Out]#        [-0.5110862 , -1.26249195],
#[Out]#        [ 0.51109806, -0.10228411],
#[Out]#        [ 0.26233576, -0.5478933 ],
#[Out]#        [ 0.98404455, -0.12436042],
#[Out]#        [-0.174864  , -0.25181557],
#[Out]#        [ 0.92757294,  0.46823621],
#[Out]#        [ 0.65959279, -0.35197629],
#[Out]#        [ 0.23454059, -0.33192183],
#[Out]#        [ 0.94236171, -0.54182226],
#[Out]#        [ 0.0432464 , -0.58148945],
#[Out]#        [ 1.11624072, -0.08421401],
#[Out]#        [ 0.35678657, -0.06682383],
#[Out]#        [ 1.29646885, -0.32756152],
#[Out]#        [ 0.92050265, -0.18239036],
#[Out]#        [ 0.71400821,  0.15037915],
#[Out]#        [ 0.89964086,  0.32961098],
#[Out]#        [ 1.33104142,  0.24466952],
#[Out]#        [ 1.55739627,  0.26739258],
#[Out]#        [ 0.81245555, -0.16233157],
#[Out]#        [-0.30733476, -0.36508661],
#[Out]#        [-0.07034289, -0.70253793],
#[Out]#        [-0.19188449, -0.67749054],
#[Out]#        [ 0.13499495, -0.31170964],
#[Out]#        [ 1.37873698, -0.42120514],
#[Out]#        [ 0.58727485, -0.48328427],
#[Out]#        [ 0.8072055 ,  0.19505396],
#[Out]#        [ 1.22042897,  0.40803534],
#[Out]#        [ 0.81286779, -0.370679  ],
#[Out]#        [ 0.24519516, -0.26672804],
#[Out]#        [ 0.16451343, -0.67966147],
#[Out]#        [ 0.46303099, -0.66952655],
#[Out]#        [ 0.89016045, -0.03381244],
#[Out]#        [ 0.22887905, -0.40225762],
#[Out]#        [-0.70708128, -1.00842476],
#[Out]#        [ 0.35553304, -0.50321849],
#[Out]#        [ 0.33112695, -0.21118014],
#[Out]#        [ 0.37523823, -0.29162202],
#[Out]#        [ 0.64169028,  0.01907118],
#[Out]#        [-0.90846333, -0.75156873],
#[Out]#        [ 0.29780791, -0.34701652],
#[Out]#        [ 2.53172698, -0.01184224],
#[Out]#        [ 1.41407223, -0.57492506],
#[Out]#        [ 2.61648461,  0.34193529],
#[Out]#        [ 1.97081495, -0.18112569],
#[Out]#        [ 2.34975798, -0.04188255],
#[Out]#        [ 3.39687992,  0.54716805],
#[Out]#        [ 0.51938325, -1.19135169],
#[Out]#        [ 2.9320051 ,  0.35237701],
#[Out]#        [ 2.31967279, -0.24554817],
#[Out]#        [ 2.91813423,  0.78038063],
#[Out]#        [ 1.66193495,  0.2420384 ],
#[Out]#        [ 1.80234045, -0.21615461],
#[Out]#        [ 2.16537886,  0.21528028],
#[Out]#        [ 1.34459422, -0.77641543],
#[Out]#        [ 1.5852673 , -0.53930705],
#[Out]#        [ 1.90474358,  0.11881899],
#[Out]#        [ 1.94924878,  0.04073026],
#[Out]#        [ 3.48876538,  1.17154454],
#[Out]#        [ 3.79468686,  0.25326557],
#[Out]#        [ 1.29832982, -0.76101394],
#[Out]#        [ 2.42816726,  0.37678197],
#[Out]#        [ 1.19809737, -0.60557896],
#[Out]#        [ 3.49926548,  0.45677347],
#[Out]#        [ 1.38766825, -0.20403099],
#[Out]#        [ 2.27585365,  0.33338653],
#[Out]#        [ 2.61419383,  0.55836695],
#[Out]#        [ 1.25762518, -0.179137  ],
#[Out]#        [ 1.29066965, -0.11642525],
#[Out]#        [ 2.12285398, -0.21085488],
#[Out]#        [ 2.3875644 ,  0.46251925],
#[Out]#        [ 2.84096093,  0.37274259],
#[Out]#        [ 3.2323429 ,  1.37052404],
#[Out]#        [ 2.15873837, -0.21832553],
#[Out]#        [ 1.4431026 , -0.14380129],
#[Out]#        [ 1.77964011, -0.50146479],
#[Out]#        [ 3.07652162,  0.68576444],
#[Out]#        [ 2.14498686,  0.13890661],
#[Out]#        [ 1.90486293,  0.04804751],
#[Out]#        [ 1.16885347, -0.1645025 ],
#[Out]#        [ 2.10765373,  0.37148225],
#[Out]#        [ 2.31430339,  0.18260885],
#[Out]#        [ 1.92245088,  0.40927118],
#[Out]#        [ 1.41407223, -0.57492506],
#[Out]#        [ 2.56332271,  0.2759745 ],
#[Out]#        [ 2.41939122,  0.30350394],
#[Out]#        [ 1.94401705,  0.18741522],
#[Out]#        [ 1.52566363, -0.37502085],
#[Out]#        [ 1.76404594,  0.07851919],
#[Out]#        [ 1.90162908,  0.11587675],
#[Out]#        [ 1.38966613, -0.28288671]])
type(x_2d)
#[Out]# numpy.ndarray
len(x_2d)
#[Out]# 150
data.shape
#[Out]# (151, 5)
data.iloc[151,:]
data.iloc[150,:]
#[Out]# sepal_length    该数据集有3个类virginica，versicolor和setosa，每类50个样本；每个...
#[Out]# sepal_width             萼片长，萼片宽，花瓣长，花瓣宽；virginica和versicolor有很多重叠
#[Out]# petal_length                                                  NaN
#[Out]# petal_width                                                   NaN
#[Out]# specie                                                        NaN
#[Out]# Name: 150, dtype: object
data = data.iloc[0:150,:]
data.tail()
#[Out]#     sepal_length sepal_width  petal_length  petal_width          specie
#[Out]# 145          6.7         3.0           5.2          2.3  Iris-virginica
#[Out]# 146          6.3         2.5           5.0          1.9  Iris-virginica
#[Out]# 147          6.5         3.0           5.2          2.0  Iris-virginica
#[Out]# 148          6.2         3.4           5.4          2.3  Iris-virginica
#[Out]# 149          5.9         3.0           5.1          1.8  Iris-virginica
data['pca1'] = x_2d[:,0]
data['pca2'] = x_2d[:,1]
data
#[Out]#     sepal_length sepal_width  petal_length  petal_width          specie  \
#[Out]# 0            5.1         3.5           1.4          0.2     Iris-setosa   
#[Out]# 1            4.9         3.0           1.4          0.2     Iris-setosa   
#[Out]# 2            4.7         3.2           1.3          0.2     Iris-setosa   
#[Out]# 3            4.6         3.1           1.5          0.2     Iris-setosa   
#[Out]# 4            5.0         3.6           1.4          0.2     Iris-setosa   
#[Out]# 5            5.4         3.9           1.7          0.4     Iris-setosa   
#[Out]# 6            4.6         3.4           1.4          0.3     Iris-setosa   
#[Out]# 7            5.0         3.4           1.5          0.2     Iris-setosa   
#[Out]# 8            4.4         2.9           1.4          0.2     Iris-setosa   
#[Out]# 9            4.9         3.1           1.5          0.1     Iris-setosa   
#[Out]# 10           5.4         3.7           1.5          0.2     Iris-setosa   
#[Out]# 11           4.8         3.4           1.6          0.2     Iris-setosa   
#[Out]# 12           4.8         3.0           1.4          0.1     Iris-setosa   
#[Out]# 13           4.3         3.0           1.1          0.1     Iris-setosa   
#[Out]# 14           5.8         4.0           1.2          0.2     Iris-setosa   
#[Out]# 15           5.7         4.4           1.5          0.4     Iris-setosa   
#[Out]# 16           5.4         3.9           1.3          0.4     Iris-setosa   
#[Out]# 17           5.1         3.5           1.4          0.3     Iris-setosa   
#[Out]# 18           5.7         3.8           1.7          0.3     Iris-setosa   
#[Out]# 19           5.1         3.8           1.5          0.3     Iris-setosa   
#[Out]# 20           5.4         3.4           1.7          0.2     Iris-setosa   
#[Out]# 21           5.1         3.7           1.5          0.4     Iris-setosa   
#[Out]# 22           4.6         3.6           1.0          0.2     Iris-setosa   
#[Out]# 23           5.1         3.3           1.7          0.5     Iris-setosa   
#[Out]# 24           4.8         3.4           1.9          0.2     Iris-setosa   
#[Out]# 25           5.0         3.0           1.6          0.2     Iris-setosa   
#[Out]# 26           5.0         3.4           1.6          0.4     Iris-setosa   
#[Out]# 27           5.2         3.5           1.5          0.2     Iris-setosa   
#[Out]# 28           5.2         3.4           1.4          0.2     Iris-setosa   
#[Out]# 29           4.7         3.2           1.6          0.2     Iris-setosa   
#[Out]# ..           ...         ...           ...          ...             ...   
#[Out]# 120          6.9         3.2           5.7          2.3  Iris-virginica   
#[Out]# 121          5.6         2.8           4.9          2.0  Iris-virginica   
#[Out]# 122          7.7         2.8           6.7          2.0  Iris-virginica   
#[Out]# 123          6.3         2.7           4.9          1.8  Iris-virginica   
#[Out]# 124          6.7         3.3           5.7          2.1  Iris-virginica   
#[Out]# 125          7.2         3.2           6.0          1.8  Iris-virginica   
#[Out]# 126          6.2         2.8           4.8          1.8  Iris-virginica   
#[Out]# 127          6.1         3.0           4.9          1.8  Iris-virginica   
#[Out]# 128          6.4         2.8           5.6          2.1  Iris-virginica   
#[Out]# 129          7.2         3.0           5.8          1.6  Iris-virginica   
#[Out]# 130          7.4         2.8           6.1          1.9  Iris-virginica   
#[Out]# 131          7.9         3.8           6.4          2.0  Iris-virginica   
#[Out]# 132          6.4         2.8           5.6          2.2  Iris-virginica   
#[Out]# 133          6.3         2.8           5.1          1.5  Iris-virginica   
#[Out]# 134          6.1         2.6           5.6          1.4  Iris-virginica   
#[Out]# 135          7.7         3.0           6.1          2.3  Iris-virginica   
#[Out]# 136          6.3         3.4           5.6          2.4  Iris-virginica   
#[Out]# 137          6.4         3.1           5.5          1.8  Iris-virginica   
#[Out]# 138          6.0         3.0           4.8          1.8  Iris-virginica   
#[Out]# 139          6.9         3.1           5.4          2.1  Iris-virginica   
#[Out]# 140          6.7         3.1           5.6          2.4  Iris-virginica   
#[Out]# 141          6.9         3.1           5.1          2.3  Iris-virginica   
#[Out]# 142          5.8         2.7           5.1          1.9  Iris-virginica   
#[Out]# 143          6.8         3.2           5.9          2.3  Iris-virginica   
#[Out]# 144          6.7         3.3           5.7          2.5  Iris-virginica   
#[Out]# 145          6.7         3.0           5.2          2.3  Iris-virginica   
#[Out]# 146          6.3         2.5           5.0          1.9  Iris-virginica   
#[Out]# 147          6.5         3.0           5.2          2.0  Iris-virginica   
#[Out]# 148          6.2         3.4           5.4          2.3  Iris-virginica   
#[Out]# 149          5.9         3.0           5.1          1.8  Iris-virginica   
#[Out]# 
#[Out]#          pca1      pca2  
#[Out]# 0   -2.684207  0.326607  
#[Out]# 1   -2.715391 -0.169557  
#[Out]# 2   -2.889820 -0.137346  
#[Out]# 3   -2.746437 -0.311124  
#[Out]# 4   -2.728593  0.333925  
#[Out]# 5   -2.279897  0.747783  
#[Out]# 6   -2.820891 -0.082105  
#[Out]# 7   -2.626482  0.170405  
#[Out]# 8   -2.887959 -0.570798  
#[Out]# 9   -2.673845 -0.106692  
#[Out]# 10  -2.506527  0.651935  
#[Out]# 11  -2.613143  0.021521  
#[Out]# 12  -2.787434 -0.227740  
#[Out]# 13  -3.225200 -0.503280  
#[Out]# 14  -2.643543  1.186195  
#[Out]# 15  -2.383869  1.344754  
#[Out]# 16  -2.622526  0.818090  
#[Out]# 17  -2.648323  0.319137  
#[Out]# 18  -2.199078  0.879244  
#[Out]# 19  -2.587346  0.520474  
#[Out]# 20  -2.310532  0.397868  
#[Out]# 21  -2.543235  0.440032  
#[Out]# 22  -3.215858  0.141616  
#[Out]# 23  -2.303129  0.105523  
#[Out]# 24  -2.356171 -0.031210  
#[Out]# 25  -2.507917 -0.139056  
#[Out]# 26  -2.469056  0.137887  
#[Out]# 27  -2.562391  0.374685  
#[Out]# 28  -2.639821  0.319290  
#[Out]# 29  -2.632848 -0.190076  
#[Out]# ..        ...       ...  
#[Out]# 120  2.428167  0.376782  
#[Out]# 121  1.198097 -0.605579  
#[Out]# 122  3.499265  0.456773  
#[Out]# 123  1.387668 -0.204031  
#[Out]# 124  2.275854  0.333387  
#[Out]# 125  2.614194  0.558367  
#[Out]# 126  1.257625 -0.179137  
#[Out]# 127  1.290670 -0.116425  
#[Out]# 128  2.122854 -0.210855  
#[Out]# 129  2.387564  0.462519  
#[Out]# 130  2.840961  0.372743  
#[Out]# 131  3.232343  1.370524  
#[Out]# 132  2.158738 -0.218326  
#[Out]# 133  1.443103 -0.143801  
#[Out]# 134  1.779640 -0.501465  
#[Out]# 135  3.076522  0.685764  
#[Out]# 136  2.144987  0.138907  
#[Out]# 137  1.904863  0.048048  
#[Out]# 138  1.168853 -0.164502  
#[Out]# 139  2.107654  0.371482  
#[Out]# 140  2.314303  0.182609  
#[Out]# 141  1.922451  0.409271  
#[Out]# 142  1.414072 -0.574925  
#[Out]# 143  2.563323  0.275975  
#[Out]# 144  2.419391  0.303504  
#[Out]# 145  1.944017  0.187415  
#[Out]# 146  1.525664 -0.375021  
#[Out]# 147  1.764046  0.078519  
#[Out]# 148  1.901629  0.115877  
#[Out]# 149  1.389666 -0.282887  
#[Out]# 
#[Out]# [150 rows x 7 columns]
data.head
#[Out]# <bound method NDFrame.head of     sepal_length sepal_width  petal_length  petal_width          specie  \
#[Out]# 0            5.1         3.5           1.4          0.2     Iris-setosa   
#[Out]# 1            4.9         3.0           1.4          0.2     Iris-setosa   
#[Out]# 2            4.7         3.2           1.3          0.2     Iris-setosa   
#[Out]# 3            4.6         3.1           1.5          0.2     Iris-setosa   
#[Out]# 4            5.0         3.6           1.4          0.2     Iris-setosa   
#[Out]# 5            5.4         3.9           1.7          0.4     Iris-setosa   
#[Out]# 6            4.6         3.4           1.4          0.3     Iris-setosa   
#[Out]# 7            5.0         3.4           1.5          0.2     Iris-setosa   
#[Out]# 8            4.4         2.9           1.4          0.2     Iris-setosa   
#[Out]# 9            4.9         3.1           1.5          0.1     Iris-setosa   
#[Out]# 10           5.4         3.7           1.5          0.2     Iris-setosa   
#[Out]# 11           4.8         3.4           1.6          0.2     Iris-setosa   
#[Out]# 12           4.8         3.0           1.4          0.1     Iris-setosa   
#[Out]# 13           4.3         3.0           1.1          0.1     Iris-setosa   
#[Out]# 14           5.8         4.0           1.2          0.2     Iris-setosa   
#[Out]# 15           5.7         4.4           1.5          0.4     Iris-setosa   
#[Out]# 16           5.4         3.9           1.3          0.4     Iris-setosa   
#[Out]# 17           5.1         3.5           1.4          0.3     Iris-setosa   
#[Out]# 18           5.7         3.8           1.7          0.3     Iris-setosa   
#[Out]# 19           5.1         3.8           1.5          0.3     Iris-setosa   
#[Out]# 20           5.4         3.4           1.7          0.2     Iris-setosa   
#[Out]# 21           5.1         3.7           1.5          0.4     Iris-setosa   
#[Out]# 22           4.6         3.6           1.0          0.2     Iris-setosa   
#[Out]# 23           5.1         3.3           1.7          0.5     Iris-setosa   
#[Out]# 24           4.8         3.4           1.9          0.2     Iris-setosa   
#[Out]# 25           5.0         3.0           1.6          0.2     Iris-setosa   
#[Out]# 26           5.0         3.4           1.6          0.4     Iris-setosa   
#[Out]# 27           5.2         3.5           1.5          0.2     Iris-setosa   
#[Out]# 28           5.2         3.4           1.4          0.2     Iris-setosa   
#[Out]# 29           4.7         3.2           1.6          0.2     Iris-setosa   
#[Out]# ..           ...         ...           ...          ...             ...   
#[Out]# 120          6.9         3.2           5.7          2.3  Iris-virginica   
#[Out]# 121          5.6         2.8           4.9          2.0  Iris-virginica   
#[Out]# 122          7.7         2.8           6.7          2.0  Iris-virginica   
#[Out]# 123          6.3         2.7           4.9          1.8  Iris-virginica   
#[Out]# 124          6.7         3.3           5.7          2.1  Iris-virginica   
#[Out]# 125          7.2         3.2           6.0          1.8  Iris-virginica   
#[Out]# 126          6.2         2.8           4.8          1.8  Iris-virginica   
#[Out]# 127          6.1         3.0           4.9          1.8  Iris-virginica   
#[Out]# 128          6.4         2.8           5.6          2.1  Iris-virginica   
#[Out]# 129          7.2         3.0           5.8          1.6  Iris-virginica   
#[Out]# 130          7.4         2.8           6.1          1.9  Iris-virginica   
#[Out]# 131          7.9         3.8           6.4          2.0  Iris-virginica   
#[Out]# 132          6.4         2.8           5.6          2.2  Iris-virginica   
#[Out]# 133          6.3         2.8           5.1          1.5  Iris-virginica   
#[Out]# 134          6.1         2.6           5.6          1.4  Iris-virginica   
#[Out]# 135          7.7         3.0           6.1          2.3  Iris-virginica   
#[Out]# 136          6.3         3.4           5.6          2.4  Iris-virginica   
#[Out]# 137          6.4         3.1           5.5          1.8  Iris-virginica   
#[Out]# 138          6.0         3.0           4.8          1.8  Iris-virginica   
#[Out]# 139          6.9         3.1           5.4          2.1  Iris-virginica   
#[Out]# 140          6.7         3.1           5.6          2.4  Iris-virginica   
#[Out]# 141          6.9         3.1           5.1          2.3  Iris-virginica   
#[Out]# 142          5.8         2.7           5.1          1.9  Iris-virginica   
#[Out]# 143          6.8         3.2           5.9          2.3  Iris-virginica   
#[Out]# 144          6.7         3.3           5.7          2.5  Iris-virginica   
#[Out]# 145          6.7         3.0           5.2          2.3  Iris-virginica   
#[Out]# 146          6.3         2.5           5.0          1.9  Iris-virginica   
#[Out]# 147          6.5         3.0           5.2          2.0  Iris-virginica   
#[Out]# 148          6.2         3.4           5.4          2.3  Iris-virginica   
#[Out]# 149          5.9         3.0           5.1          1.8  Iris-virginica   
#[Out]# 
#[Out]#          pca1      pca2  
#[Out]# 0   -2.684207  0.326607  
#[Out]# 1   -2.715391 -0.169557  
#[Out]# 2   -2.889820 -0.137346  
#[Out]# 3   -2.746437 -0.311124  
#[Out]# 4   -2.728593  0.333925  
#[Out]# 5   -2.279897  0.747783  
#[Out]# 6   -2.820891 -0.082105  
#[Out]# 7   -2.626482  0.170405  
#[Out]# 8   -2.887959 -0.570798  
#[Out]# 9   -2.673845 -0.106692  
#[Out]# 10  -2.506527  0.651935  
#[Out]# 11  -2.613143  0.021521  
#[Out]# 12  -2.787434 -0.227740  
#[Out]# 13  -3.225200 -0.503280  
#[Out]# 14  -2.643543  1.186195  
#[Out]# 15  -2.383869  1.344754  
#[Out]# 16  -2.622526  0.818090  
#[Out]# 17  -2.648323  0.319137  
#[Out]# 18  -2.199078  0.879244  
#[Out]# 19  -2.587346  0.520474  
#[Out]# 20  -2.310532  0.397868  
#[Out]# 21  -2.543235  0.440032  
#[Out]# 22  -3.215858  0.141616  
#[Out]# 23  -2.303129  0.105523  
#[Out]# 24  -2.356171 -0.031210  
#[Out]# 25  -2.507917 -0.139056  
#[Out]# 26  -2.469056  0.137887  
#[Out]# 27  -2.562391  0.374685  
#[Out]# 28  -2.639821  0.319290  
#[Out]# 29  -2.632848 -0.190076  
#[Out]# ..        ...       ...  
#[Out]# 120  2.428167  0.376782  
#[Out]# 121  1.198097 -0.605579  
#[Out]# 122  3.499265  0.456773  
#[Out]# 123  1.387668 -0.204031  
#[Out]# 124  2.275854  0.333387  
#[Out]# 125  2.614194  0.558367  
#[Out]# 126  1.257625 -0.179137  
#[Out]# 127  1.290670 -0.116425  
#[Out]# 128  2.122854 -0.210855  
#[Out]# 129  2.387564  0.462519  
#[Out]# 130  2.840961  0.372743  
#[Out]# 131  3.232343  1.370524  
#[Out]# 132  2.158738 -0.218326  
#[Out]# 133  1.443103 -0.143801  
#[Out]# 134  1.779640 -0.501465  
#[Out]# 135  3.076522  0.685764  
#[Out]# 136  2.144987  0.138907  
#[Out]# 137  1.904863  0.048048  
#[Out]# 138  1.168853 -0.164502  
#[Out]# 139  2.107654  0.371482  
#[Out]# 140  2.314303  0.182609  
#[Out]# 141  1.922451  0.409271  
#[Out]# 142  1.414072 -0.574925  
#[Out]# 143  2.563323  0.275975  
#[Out]# 144  2.419391  0.303504  
#[Out]# 145  1.944017  0.187415  
#[Out]# 146  1.525664 -0.375021  
#[Out]# 147  1.764046  0.078519  
#[Out]# 148  1.901629  0.115877  
#[Out]# 149  1.389666 -0.282887  
#[Out]# 
#[Out]# [150 rows x 7 columns]>
date.head()
data.head()
#[Out]#   sepal_length sepal_width  petal_length  petal_width       specie      pca1  \
#[Out]# 0          5.1         3.5           1.4          0.2  Iris-setosa -2.684207   
#[Out]# 1          4.9         3.0           1.4          0.2  Iris-setosa -2.715391   
#[Out]# 2          4.7         3.2           1.3          0.2  Iris-setosa -2.889820   
#[Out]# 3          4.6         3.1           1.5          0.2  Iris-setosa -2.746437   
#[Out]# 4          5.0         3.6           1.4          0.2  Iris-setosa -2.728593   
#[Out]# 
#[Out]#        pca2  
#[Out]# 0  0.326607  
#[Out]# 1 -0.169557  
#[Out]# 2 -0.137346  
#[Out]# 3 -0.311124  
#[Out]# 4  0.333925  
sns.lmplot('pca1','pca2',hue='specie',data=data,fit_reg=False)
#[Out]# <seaborn.axisgrid.FacetGrid at 0x20dfa343320>
data['specie'].value_counts()
#[Out]# Iris-versicolor    50
#[Out]# Iris-setosa        50
#[Out]# Iris-virginica     50
#[Out]# Name: specie, dtype: int64
from sklearn.mixture import GMM
model = GMM(n_components=3,covariance_type='full')
model.fit(x_data)
#[Out]# GMM(covariance_type='full', init_params='wmc', min_covar=0.001,
#[Out]#   n_components=3, n_init=1, n_iter=100, params='wmc', random_state=None,
#[Out]#   tol=0.001, verbose=0)
y_gmm = model.predict(x_data)
data['cluster'] = y_gmm
sns.lmplot('pca1','pca2',data=data,hue='species',col='cluster',fit_reg=False)
sns.lmplot('pca1','pca2',data=data,hue='specie',col='cluster',fit_reg=False)
#[Out]# <seaborn.axisgrid.FacetGrid at 0x20dfbbb3208>
get_ipython().run_line_magic('pinfo', 'sns.lmplot')
data.columns
#[Out]# Index(['sepal_length', 'sepal_width', 'petal_length', 'petal_width', 'specie',
#[Out]#        'pca1', 'pca2', 'cluster'],
#[Out]#       dtype='object')
from sklearn.datasets import load_digits
digits = load_digits()
digits.image.shape
digits.images.shape
#[Out]# (1797, 8, 8)
fig,axes = plt.subplots(10,10,figsize=(8,8),subplot_kw ={'xticks':[],'yticks'"[]},girdspec_kw=dict(hspace=0.1,wspace=0.1))
fig,axes = plt.subplots(10,10,figsize=(8,8),subplot_kw ={'xticks':[],'yticks':[]},girdspec_kw=dict(hspace=0.1,wspace=0.1))
fig,axes = plt.subplots(10,10,figsize=(8,8),subplot_kw ={'xticks':[],'yticks':[]},gridspec_kw=dict(hspace=0.1,wspace=0.1))
for i,ax in enumerate(axe.flat):
    ax.imshow(digits.image[i],cmap='binary')
    ax.text(0.05,0.05,str(digits.target[i]),transform=ax.transAxes,color='green')
    
for i,ax in enumerate(axes.flat):
    ax.imshow(digits.image[i],cmap='binary')
    ax.text(0.05,0.05,str(digits.target[i]),transform=ax.transAxes,color='green')
    
for i,ax in enumerate(axes.flat):
    ax.imshow(digits.images[i],cmap='binary')
    ax.text(0.05,0.05,str(digits.target[i]),transform=ax.transAxes,color='green')
    
x = digits.data
x.shape
#[Out]# (1797, 64)
y = digits.target
y.shape
#[Out]# (1797,)
from sklearn.manifold import Isomap
iso = Isomap(n_components=2)
iso.fit(digits.data)
#[Out]# Isomap(eigen_solver='auto', max_iter=None, n_components=2, n_jobs=1,
#[Out]#     n_neighbors=5, neighbors_algorithm='auto', path_method='auto', tol=0)
data_projected = iso.transform(digits.data)
iso.shape
data_projected.shape
#[Out]# (1797, 2)
plt.scatter(data_projected[:,0],data_projected[:,1],c=digits,edgecolors='none',alpha=0.5,cmap=plt.cm.get_cmap('spectral',10))
plt.scatter(data_projected[:,0],data_projected[:,1],c=digits,edgecolor='none',alpha=0.5,cmap=plt.cm.get_cmap('spectral',10))
get_ipython().run_line_magic('pinfo', 'plt.scatter')
plt.scatter(data_projected[:,0],data_projected[:,1],edgecolo='none',alpha=0.5,cmap=plt.cm.get_cmap('spectral',10))
plt.scatter(data_projected[:,0],data_projected[:,1],edgecolor='none',alpha=0.5,cmap=plt.cm.get_cmap('spectral',10))
#[Out]# <matplotlib.collections.PathCollection at 0x20d867361d0>
xtrain,xtest,ytrain,ytest = train_test_split(x,y,random_sample=14)
xtrain,xtest,ytrain,ytest = train_test_split(x,y,random_state=10)
from sklearn.naive_bayes import GaussianNB
model = GaussianNB()
model.fit(xtrain,ytrain)
#[Out]# GaussianNB(priors=None)
x
#[Out]# array([[ 0.,  0.,  5., ...,  0.,  0.,  0.],
#[Out]#        [ 0.,  0.,  0., ..., 10.,  0.,  0.],
#[Out]#        [ 0.,  0.,  0., ..., 16.,  9.,  0.],
#[Out]#        ...,
#[Out]#        [ 0.,  0.,  1., ...,  6.,  0.,  0.],
#[Out]#        [ 0.,  0.,  2., ..., 12.,  0.,  0.],
#[Out]#        [ 0.,  0., 10., ..., 12.,  1.,  0.]])
y
#[Out]# array([0, 1, 2, ..., 8, 9, 8])
y_model = mode.predict(xtest)
y_model = model.predict(xtest)
from sklearn.metrics import accuracy_score
accuracy_score(ytest,y_model)
#[Out]# 0.8066666666666666
from sklearn.metric import confusion_matrix
from sklearn.metrics import confusion_matrix
mat = confusion_matrix(ytest,y_model)
sns.heatmap(mat,square=True,annot=True,cbar=False)
#[Out]# <matplotlib.axes._subplots.AxesSubplot at 0x20dfec1b320>
plt.xlabel('predicted value')
#[Out]# Text(0.5,14.1922,'predicted value')
plt.ylabel('true value')
#[Out]# Text(44.8772,0.5,'true value')
fig,axes = plt.subplots(10,10,figsize=(8,8),subplot_kw={'xticks':[],'yticks':[]},gridspec_kw=dict(hspace=0.1,wspace=0.1))
test_images = xtest.reshape(-1,8,8)
for i,ax in enumerate(axes.flat):
    ax.imshow(test_images[i],cmap='binary')
    ax.text(0.05,0.05,str(y_model[i]),transform=ax.tranAxes,color='green' if (ytest[i] == y_model[i]))
for i,ax in enumerate(axes.flat):
    ax.imshow(test_images[i],cmap='binary')
    ax.text(0.05,0.05,str(y_model[i]),transform=ax.tranAxes,color='green' if ytest[i] == y_model[i])
get_ipython().run_line_magic('logstate', '')
get_ipython().run_line_magic('logstop', '')
